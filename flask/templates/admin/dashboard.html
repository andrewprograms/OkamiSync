{% extends "base.html" %}
{% block title %} - Admin{% endblock %}
{% block content %}
<h5>Admin — Menu & Tables</h5>
<div class="row g-3">
  <div class="col-12 col-xl-6">
    <div class="card">
      <div class="card-body">
        <h6>Categories</h6>
        <ul class="list-group mb-3" id="cat-list">
          {% for c in categories %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            {{ c.name }}
            <span class="badge bg-light text-muted">order: {{ c.sort_order }}</span>
          </li>
          {% endfor %}
        </ul>
        <form id="form-add-cat" class="row g-2">
          <div class="col-6"><input class="form-control" name="name" placeholder="New category" required></div>
          <div class="col-3"><input class="form-control" name="sort_order" type="number" value="0"></div>
          <div class="col-3"><button class="btn btn-primary w-100">Add</button></div>
        </form>
      </div>
    </div>
  </div>
  <div class="col-12 col-xl-6">
    <div class="card">
      <div class="card-body">
        <h6>Menu Items</h6>
        <div id="item-list" class="list-group" style="max-height: 400px; overflow:auto;">
          {% for i in items %}
          <div class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <strong>{{ i.name }}</strong>
              <div class="small text-muted">{{ i.category.name }} — ${{ '%.2f'|(i.price_cents/100) }}</div>
            </div>
            <span class="badge bg-{{ 'success' if i.is_active else 'secondary' }}">{{ 'Active' if i.is_active else 'Hidden' }}</span>
          </div>
          {% endfor %}
        </div>

        <hr/>
        <h6 class="mt-2">Quick Add Item</h6>
        <form id="form-add-item" class="row g-2">
          <div class="col-6">
            <select class="form-select" name="category_id" required>
              {% for c in categories %}
                <option value="{{ c.id }}">{{ c.name }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-6"><input class="form-control" name="name" placeholder="Name" required></div>
          <div class="col-12"><input class="form-control" name="description" placeholder="Description"></div>
          <div class="col-4"><input class="form-control" name="price_cents" type="number" placeholder="Price cents" required></div>
          <div class="col-8"><input class="form-control" name="image_url" placeholder="Image URL (optional)"></div>
          <div class="col-12"><button class="btn btn-primary">Add Item</button></div>
        </form>
      </div>
    </div>
  </div>
</div>

<div class="card mt-3">
  <div class="card-body">
    <h6>Tables & QR</h6>
    <div class="row g-2 align-items-end">
      <div class="col-3"><input class="form-control" id="table-code" placeholder="Code (e.g. C3)"></div>
      <div class="col-5"><input class="form-control" id="table-label" placeholder="Label (e.g. Table C)"></div>
      <div class="col-4"><button id="btn-add-table" class="btn btn-primary w-100">Create Table</button></div>
    </div>
    <div class="row g-2 mt-3" id="table-list">
      {% for t in tables %}
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card">
          <div class="card-body">
            <div class="d-flex justify-content-between">
              <strong>{{ t.label }}</strong>
              <span class="text-muted">{{ t.code }}</span>
            </div>
            <img class="img-fluid mt-2" src="/admin/qr/{{ t.code }}.png" alt="QR">
            <a class="btn btn-sm btn-outline-secondary mt-2" href="/t/{{ t.code }}" target="_blank">Open</a>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}
